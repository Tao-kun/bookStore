{% extends 'Base.html' %}
{% load staticfiles %}
{% block content %}
    <link rel="stylesheet" type="text/css" href="../../../static/libraries/lib.css">
    <link rel="stylesheet" type="text/css" href="../../../static/css/bootstrap.css">
    <div class="container">
        <table class="table table-striped">
            <thead>
            <tr>
                <th style="padding-left: 4%">订单号</th>
                <th style="padding-left: 12%">下单日期</th>
                <th style="padding-left: 12%">发货日期</th>
                <th style="padding-left: 5%">订单状态</th>
                <th style="padding-left: 5%">详细信息</th>
            </tr>
            </thead>
            <tbody>
            {% for order in all_order %}
                <tr>
                    <td>{{ order.orderid }}</td>
                    <td>{{ order.orderdate }}</td>
                    <td>{{ order.shipdate }}</td>

                    {% if order.IsHandled == 1 and order.IsCancle == 0 and order.IsShipped == 0 %}
                        <td>已确认</td>
                    {% elif order.IsCancle == 1 %}
                        <td>已取消</td>
                    {% elif order.IsHandled == 0 %}
                        <td>未确认</td>
                    {% elif order.IsShipped == 1 and order.IsReturn == 0 and order.IsCompleted == 0 %}
                        <td>已发货</td>
                    {% elif order.IsReturn == 1 and order.IsCancled == 0 and order.IsCompleted == 0 %}
                        <td>退货处理中</td>
                    {% elif order.IsCancled == 1 %}
                        <td>已退款</td>
                    {% elif order.IsCompleted == 1 %}
                        <td>已完成</td>
                    {% endif %}
                    <td><a id="detail_info">detail</a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <script src="{% static "js/jquery-1.7.2.min.js" %}"></script>
    <script src="{% static "js/layer/layer.js" %}"></script>
    <script>

        $(function () {
            $("a[id='detail_info']").each(function () {
                var currentEle = $(this);
                var order_id = currentEle.parent().prev().prev().prev().prev().html();
                currentEle.on('click', function () {
                    layer.open({
                        type: 2,
                        area: ['800px', '600px'],
                        shadeClose: true, //点击遮罩关闭
                        content: '/order_detail/?order_id=' + order_id,
                        end: function () {
                            location.reload();
                        }
                    });
                })
            })
        })

    </script>
{% endblock %}